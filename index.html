<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>R.M. Est√©tica Automotiva - Gest√£o</title>
<style>
  body {
    background: #121212;
    color: #ddd;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 20px;
  }
  h2 {
    color: #ffb347; /* amarelo suave */
  }
  /* Lista slim */
  .lista-slim {
    list-style: none;
    padding: 0;
    margin: 0 0 30px 0;
    font-size: 14px;
    border: 1px solid #333;
    border-radius: 6px;
    background: #1e1e1e;
  }
  .lista-slim li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 12px;
    border-bottom: 1px solid #333;
  }
  .lista-slim li:last-child {
    border-bottom: none;
  }
  .item-info {
    flex: 1;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  .item-actions button {
    background: transparent;
    border: none;
    color: #ffb347;
    cursor: pointer;
    margin-left: 10px;
    font-size: 18px;
    transition: color 0.2s ease;
  }
  .item-actions button:hover {
    color: #ffd966;
  }
  /* T√≠tulo se√ß√µes */
  section {
    max-width: 480px;
    margin-bottom: 40px;
  }
</style>
</head>
<body>

<h1>R.M. Est√©tica Automotiva - Gest√£o</h1>

<section>
  <h2>Clientes Cadastrados</h2>
  <ul id="lista-clientes" class="lista-slim">
    <!-- Clientes aparecem aqui -->
  </ul>
</section>

<section>
  <h2>Servi√ßos Dispon√≠veis</h2>
  <ul id="lista-servicos" class="lista-slim">
    <!-- Servi√ßos aparecem aqui -->
  </ul>
</section>

<script type="module">
  import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

  const supabaseUrl = 'https://zkdfimbfwgofkmmcvyfu.supabase.co';
  const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InprZGZpbWJmd2dvZmttbWN2eWZ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA2MzQxMTksImV4cCI6MjA2NjIxMDExOX0.vOTrEVYX30FpWPQykY5CF1QCfkyG5gDLnI_2N9TATRE';

  const supabase = createClient(supabaseUrl, supabaseKey);

  // Fun√ß√£o para carregar clientes
  async function carregarClientesSlim() {
    const { data, error } = await supabase.from('clientes').select();
    if (error) {
      alert('Erro ao carregar clientes: ' + error.message);
      return;
    }
    const listaClientes = document.getElementById('lista-clientes');
    listaClientes.innerHTML = '';
    data.forEach(cliente => {
      const li = document.createElement('li');
      li.innerHTML = `
        <div class="item-info">${cliente.nome} ‚Äî ${cliente.telefone || 'Sem telefone'}</div>
        <div class="item-actions">
          <button title="Editar" onclick="editarCliente(${cliente.id})">‚úèÔ∏è</button>
          <button title="Excluir" onclick="excluirCliente(${cliente.id})">üóëÔ∏è</button>
        </div>
      `;
      listaClientes.appendChild(li);
    });
  }

  // Fun√ß√£o para carregar servi√ßos
  async function carregarServicosSlim() {
    const { data, error } = await supabase.from('servicos').select();
    if (error) {
      alert('Erro ao carregar servi√ßos: ' + error.message);
      return;
    }
    const listaServicos = document.getElementById('lista-servicos');
    listaServicos.innerHTML = '';
    data.forEach(servico => {
      const li = document.createElement('li');
      li.innerHTML = `
        <div class="item-info">${servico.descricao} ‚Äî R$ ${servico.valor.toFixed(2)}</div>
        <div class="item-actions">
          <button title="Editar" onclick="editarServico(${servico.id})">‚úèÔ∏è</button>
          <button title="Excluir" onclick="excluirServico(${servico.id})">üóëÔ∏è</button>
        </div>
      `;
      listaServicos.appendChild(li);
    });
  }

  // Fun√ß√µes fict√≠cias de editar/excluir ‚Äî voc√™ pode implementar depois
  window.editarCliente = function(id) {
    alert('Editar cliente ID: ' + id + ' - implementar funcionalidade.');
  }
  window.excluirCliente = async function(id) {
    if (!confirm('Confirma exclus√£o do cliente ID: ' + id + '?')) return;
    const { error } = await supabase.from('clientes').delete().eq('id', id);
    if (error) {
      alert('Erro ao excluir cliente: ' + error.message);
      return;
    }
    carregarClientesSlim();
  }

  window.editarServico = function(id) {
    alert('Editar servi√ßo ID: ' + id + ' - implementar funcionalidade.');
  }
  window.excluirServico = async function(id) {
    if (!confirm('Confirma exclus√£o do servi√ßo ID: ' + id + '?')) return;
    const { error } = await supabase.from('servicos').delete().eq('id', id);
    if (error) {
      alert('Erro ao excluir servi√ßo: ' + error.message);
      return;
    }
    carregarServicosSlim();
  }

  // Inicializa
  carregarClientesSlim();
  carregarServicosSlim();

</script>

</body>
</html>
