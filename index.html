<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>R.M. Est√©tica Automotiva</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; background: #f1f1f1; }
    h1 {
      background: linear-gradient(to right, #8B0000, #A52A2A);
      color: white; padding: 15px; text-align: center; margin: 0;
    }
    .menu {
      display: flex; justify-content: space-around; background: #fff; padding: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .menu button {
      background: none; border: none; font-size: 16px; cursor: pointer; padding: 10px;
    }
    .menu button:hover { background: #ffd700; border-radius: 5px; }
    .aba { display: none; padding: 20px; }
    .ativa { display: block; }
    input, button, select {
      width: 100%; padding: 10px; margin: 8px 0; font-size: 16px;
      border-radius: 5px; border: 1px solid #ccc;
    }
    .botao { background: #8B0000; color: white; border: none; }
    .botao:hover { background: #A52A2A; }
    .item {
      background: white; margin: 8px 0; padding: 10px; border-radius: 6px;
      display: flex; justify-content: space-between; align-items: center;
    }
    .item span { font-weight: bold; }
  </style>
</head>
<body>
  <h1>‚ú® R.M. Est√©tica Automotiva ‚ú®</h1>
  <div class="menu">
    <button onclick="mostrarAba('clientes')">üë§ Clientes</button>
    <button onclick="mostrarAba('servicos')">üõ†Ô∏è Servi√ßos</button>
    <button onclick="mostrarAba('orcamentos')">üßæ Or√ßamentos</button>
    <button onclick="mostrarAba('historico')">üì¶ Hist√≥rico</button>
  </div>

  <div id="clientes" class="aba ativa">
    <h2>Cadastro de Clientes</h2>
    <input type="text" id="nomeCliente" placeholder="Nome do Cliente">
    <input type="text" id="carroCliente" placeholder="Carro">
    <input type="text" id="placaCliente" placeholder="Placa">
    <button class="botao" onclick="salvarCliente()">Salvar Cliente</button>
    <div id="listaClientes"></div>
  </div>

  <div id="servicos" class="aba">
    <h2>Cadastro de Servi√ßos</h2>
    <input type="text" id="nomeServico" placeholder="Nome do Servi√ßo">
    <input type="number" id="precoServico" placeholder="Pre√ßo">
    <button class="botao" onclick="salvarServico()">Salvar Servi√ßo</button>
    <div id="listaServicos"></div>
  </div>

  <div id="orcamentos" class="aba">
    <h2>Montar Or√ßamento</h2>
    <select id="selectCliente"></select>
    <select id="selectServico"></select>
    <button class="botao" onclick="gerarOrcamento()">Finalizar Or√ßamento</button>
  </div>

  <div id="historico" class="aba">
    <h2>Hist√≥rico de Or√ßamentos</h2>
    <div id="listaHistorico"></div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDS59CJPcKUkzG--dGS8noq1sPGb0Vyioc",
      authDomain: "oficina-f92e4.firebaseapp.com",
      projectId: "oficina-f92e4",
      storageBucket: "oficina-f92e4.firebasestorage.app",
      messagingSenderId: "302619302245",
      appId: "1:302619302245:web:c9eea1fa71e48d25eee98c"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    function mostrarAba(id) {
      document.querySelectorAll(".aba").forEach(div => div.classList.remove("ativa"));
      document.getElementById(id).classList.add("ativa");
    }

    function salvarCliente() {
      const nome = document.getElementById("nomeCliente").value;
      const carro = document.getElementById("carroCliente").value;
      const placa = document.getElementById("placaCliente").value;
      if (!nome || !carro || !placa) return alert("Preencha todos os campos");
      db.collection("clientes").add({ nome, carro, placa }).then(() => {
        document.getElementById("nomeCliente").value = "";
        document.getElementById("carroCliente").value = "";
        document.getElementById("placaCliente").value = "";
        carregarClientes();
      });
    }

    function salvarServico() {
      const nome = document.getElementById("nomeServico").value;
      const preco = parseFloat(document.getElementById("precoServico").value);
      if (!nome || !preco) return alert("Preencha todos os campos");
      db.collection("servicos").add({ nome, preco }).then(() => {
        document.getElementById("nomeServico").value = "";
        document.getElementById("precoServico").value = "";
        carregarServicos();
      });
    }

    function gerarOrcamento() {
      const cliente = document.getElementById("selectCliente").value;
      const servico = document.getElementById("selectServico").value;
      if (!cliente || !servico) return alert("Selecione cliente e servi√ßo");
      db.collection("historico").add({ cliente, servico, data: new Date().toLocaleString() })
      .then(() => carregarHistorico());
    }

    function carregarClientes() {
      const lista = document.getElementById("listaClientes");
      const select = document.getElementById("selectCliente");
      lista.innerHTML = "";
      select.innerHTML = "<option value=''>Selecione um cliente</option>";
      db.collection("clientes").get().then(snapshot => {
        snapshot.forEach(doc => {
          const data = doc.data();
          const item = `<div class="item"><span>${data.nome}</span> - ${data.carro} | ${data.placa}</div>`;
          lista.innerHTML += item;
          select.innerHTML += `<option value="${data.nome}">${data.nome}</option>`;
        });
      });
    }

    function carregarServicos() {
      const lista = document.getElementById("listaServicos");
      const select = document.getElementById("selectServico");
      lista.innerHTML = "";
      select.innerHTML = "<option value=''>Selecione um servi√ßo</option>";
      db.collection("servicos").get().then(snapshot => {
        snapshot.forEach(doc => {
          const data = doc.data();
          const item = `<div class="item"><span>${data.nome}</span> - R$ ${data.preco.toFixed(2)}</div>`;
          lista.innerHTML += item;
          select.innerHTML += `<option value="${data.nome}">${data.nome} - R$ ${data.preco}</option>`;
        });
      });
    }

    function carregarHistorico() {
      const lista = document.getElementById("listaHistorico");
      lista.innerHTML = "";
      db.collection("historico").orderBy("data", "desc").get().then(snapshot => {
        snapshot.forEach(doc => {
          const data = doc.data();
          lista.innerHTML += `<div class="item">
            <div><span>${data.cliente}</span> - ${data.servico}</div>
            <div>${data.data}</div>
          </div>`;
        });
      });
    }

    window.onload = () => {
      carregarClientes();
      carregarServicos();
      carregarHistorico();
    };
  </script>
</body>
</html>
